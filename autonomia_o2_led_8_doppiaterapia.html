<script>
/* =========================
   CONFIGURAZIONE BASE
========================= */
const TOTAL_LITERS = 26500;
const LED_COUNT = 8;
const LITERS_PER_LED = TOTAL_LITERS / LED_COUNT;

/* =========================
   ELEMENTI DOM
========================= */
const ledInput = document.getElementById("ledInput");

const flow1Input = document.getElementById("flow1");
const hours1Input = document.getElementById("hours1");

const flow2Input = document.getElementById("flow2");
const hours2Input = document.getElementById("hours2");

const ledObservedEl = document.getElementById("ledObserved");
const ledCalcEl = document.getElementById("ledCalc");

const residualLitersEl = document.getElementById("residualLiters");
const autonomyHoursEl = document.getElementById("autonomyHours");
const autonomyDaysEl = document.getElementById("autonomyDays");
const dailyConsumptionEl = document.getElementById("dailyConsumption");

/* =========================
   FUNZIONE PRINCIPALE
========================= */
function calculate() {
  /* LED */
  const ledObserved = Math.max(1, Math.min(LED_COUNT, Number(ledInput.value)));
  const ledForCalc = Math.max(1, ledObserved - 1);

  /* Terapia 1 */
  const flow1 = Number(flow1Input.value) || 0;
  const hours1 = Number(hours1Input.value) || 0;

  /* Terapia 2 (opzionale) */
  const flow2 = Number(flow2Input.value) || 0;
  const hours2 = Number(hours2Input.value) || 0;

  /* Consumo giornaliero totale */
  const dailyConsumption =
    (flow1 * hours1 * 60) +
    (flow2 * hours2 * 60);

  /* Litri residui */
  const residualLiters = ledForCalc * LITERS_PER_LED;

  /* Autonomia */
  let autonomyHours = 0;
  let autonomyDays = 0;

  if (dailyConsumption > 0) {
    autonomyDays = residualLiters / dailyConsumption;
    autonomyHours = autonomyDays * 24;
  }

  /* =========================
     OUTPUT
  ========================= */
  ledObservedEl.textContent = ledObserved;
  ledCalcEl.textContent = ledForCalc;

  residualLitersEl.textContent = Math.round(residualLiters).toLocaleString("it-IT");
  dailyConsumptionEl.textContent = Math.round(dailyConsumption).toLocaleString("it-IT");

  autonomyHoursEl.textContent = autonomyHours ? Math.round(autonomyHours) : "—";
  autonomyDaysEl.textContent = autonomyDays ? autonomyDays.toFixed(1) : "—";
}

/* =========================
   EVENTI
========================= */
[
  ledInput,
  flow1Input, hours1Input,
  flow2Input, hours2Input
].forEach(el => el.addEventListener("input", calculate));

/* CALCOLO INIZIALE */
calculate();
</script>
